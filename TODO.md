# envault TODO リスト

## 実装したが実現できなかった機能

### 1. `export`コマンドによる環境変数の直接設定

#### 課題
`export`コマンドを使用して環境変数を直接現在のシェルに設定することができませんでした。これは、Goのプログラムが子プロセスとして実行され、その子プロセス内で設定された環境変数が親シェルに影響を与えないという技術的制限によるものです。

#### 試みた解決策
1. **シェルスクリプトの出力と評価**
   - `envault export --output-script-only`コマンドを実装し、環境変数を設定するシェルスクリプトを出力
   - ユーザーが`eval $(envault export --output-script-only)`または`source <(envault export --output-script-only)`を使用して実行する必要がある
   - この方法は技術的には機能しますが、ユーザー体験が理想的ではありません

2. **一時ファイルを使用したスクリプト生成**
   - 一時ファイルにシェルスクリプトを書き込み、それを`source`コマンドで実行する方法
   - 対話式のパスワード入力と組み合わせると問題が発生

#### 現在の制限
- 対話式のパスワード入力とシェルの評価を組み合わせると、エラーが発生することがある
- `source <(./envault export)`を実行すると、以下のようなエラーが発生:
  ```
  -bash: 復号化用パスワードを入力してください:: コマンドが見つかりません
  -bash: /var/folders/p4/j0g1g0rd0vv2pfmr8ndpc6ym0000gn/T/envault-3202128578.sh: No such file or directory
  -bash: 2個の環境変数をエクスポートしました: コマンドが見つかりません
  ```

### 2. 将来の改善案

1. **代替アプローチ**
   - `dump`コマンドを実装して暗号化されたファイルの内容を表示する機能を追加（実装済み）
   - シェルのラッパースクリプトを提供して、より簡単に環境変数を設定できるようにする

2. **他の改善案**
   - パスワード強度チェック機能の追加
   - 複数の.envファイルの管理機能
   - GUIインターフェースの提供

## 技術的な制約

Goのようなプログラミング言語で作成されたプログラムは、親シェルの環境変数を直接変更することができないという根本的な制約があります。これはOSのセキュリティモデルによるものであり、子プロセスは親プロセスの環境を変更できないようになっています。

この制約を回避するための一般的な方法は、シェルスクリプトを生成して、それを`eval`または`source`コマンドで実行することですが、対話式の入力と組み合わせると問題が発生することがあります。

## 今後の方向性

1. `--output-script-only`フラグを使用した現在のアプローチを改善
2. 対話式入力とシェルスクリプト評価の問題を解決するための代替手段を検討
3. `dump`コマンドを使用して、ユーザーが手動で環境変数を設定する方法を推奨
